serviceMaps:
  serviceName: fieldPlan
  mappings:
    - version: 1.0
      name: Activity
      description: Persists Activity Assignment details in Activity Assignment table
      fromTopic: save-activity-assignment-topic
      isTransaction: true
      isAuditEnabled: true
      module: Activity
      objecIdJsonPath: $.id
      tenantIdJsonPath: $.tenantId
      userUuidJsonPath: $.[0].auditDetails.createdBy
      transactionCodeJsonPath: $.id
      auditAttributeBasePath: $.*
      queryMaps:
        - query: INSERT INTO activity_assignments (id,tenant_id,field_plan_id,activity_id,start_date,end_date,assigned_to,assigned_by,additional_details,status,created_time,last_modified_time) VALUES (?,?,?,?,?,?,?,?,?,?,?,?);
          basePath: $.ActivityAssignment.*
          jsonMaps:
            - jsonPath: $.ActivityAssignment.*.id

            - jsonPath: $.ActivityAssignment.*.tenantId

            - jsonPath: $.ActivityAssignment.*.fieldPlanId

            - jsonPath: $.ActivityAssignment.*.activityId

            - jsonPath: $.ActivityAssignment.*.startDate

            - jsonPath: $.ActivityAssignment.*.endDate

            - jsonPath: $.ActivityAssignment.*.assignedTo

            - jsonPath: $.ActivityAssignment.*.assignedBy

            - jsonPath: $.ActivityAssignment.*.additionalDetails
              type: JSON
              dbType: JSONB

            - jsonPath: $.ActivityAssignment.*.status

            - jsonPath: $.ActivityAssignment.*.auditDetails.createdTime

            - jsonPath: $.ActivityAssignment.*.auditDetails.lastModifiedTime

    - version: 1.0
      name: Activity
      description: Persists Activity Facility details in Activity Facility table
      fromTopic: save-activity-assignment-topic
      isTransaction: true
      isAuditEnabled: true
      module: Activity
      objecIdJsonPath: $.id
      tenantIdJsonPath: $.tenantId
      userUuidJsonPath: $.[0].auditDetails.createdBy
      transactionCodeJsonPath: $.id
      auditAttributeBasePath: $.*
      queryMaps:
        - query: INSERT INTO facility_activities (id,tenant_id,field_plan_id,activity_id,facility_id, status, conditions_met, assigned_user, scheduled_at, activated_at, completed_at, additional_details, created_time, last_modified_time) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?);
          basePath: $.ActivitiesFacilities.*
          jsonMaps:
            - jsonPath: $.ActivitiesFacilities.*.id

            - jsonPath: $.ActivitiesFacilities.*.tenantId

            - jsonPath: $.ActivitiesFacilities.*.fieldPlanId

            - jsonPath: $.ActivitiesFacilities.*.activityId

            - jsonPath: $.ActivitiesFacilities.*.facilityId

            - jsonPath: $.ActivitiesFacilities.*.status

            - jsonPath: $.ActivitiesFacilities.*.conditionsMet
              type: JSON
              dbType: JSONB

            - jsonPath: $.ActivitiesFacilities.*.assignedUser

            - jsonPath: $.ActivitiesFacilities.*.scheduledAt

            - jsonPath: $.ActivitiesFacilities.*.activatedAt

            - jsonPath: $.ActivitiesFacilities.*.completedAt

            - jsonPath: $.ActivitiesFacilities.*.additionalDetails
              type: JSON
              dbType: JSONB

            - jsonPath: $.ActivitiesFacilities.*.auditDetails.createdTime

            - jsonPath: $.ActivitiesFacilities.*.auditDetails.lastModifiedTime

    - version: 1.0
      name: Activity
      description: Updates activity details in activity_facilities table
      fromTopic: update-activity-facility
      isTransaction: true
      isAuditEnabled: true
      module: ACTIVITY
      objecIdJsonPath: $.id
      tenantIdJsonPath: $.tenantId
      userUuidJsonPath: $.[0].auditDetails.createdBy
      transactionCodeJsonPath: $.id
      auditAttributeBasePath: $.*
      queryMaps:
        - query: UPDATE facility_activities SET  assigned_user=?, scheduled_at=?, activated_at=?, completed_at=?, status = ?, conditions_met=?, additional_details = ?, last_modified_time = ? WHERE id = ?;
          basePath: $.ActivitiesFacilities.*
          jsonMaps:
            - jsonPath: $.ActivitiesFacilities.*.assignedUser

            - jsonPath: $.ActivitiesFacilities.*.scheduledAt

            - jsonPath: $.ActivitiesFacilities.*.activatedAt

            - jsonPath: $.ActivitiesFacilities.*.completedAt

            - jsonPath: $.ActivitiesFacilities.*.status

            - jsonPath: $.ActivitiesFacilities.*.conditionsMet
              type: JSON
              dbType: JSONB

            - jsonPath: $.ActivitiesFacilities.*.additionalDetails
              type: JSON
              dbType: JSONB

            - jsonPath: $.ActivitiesFacilities.*.auditDetails.lastModifiedTime

            - jsonPath: $.ActivitiesFacilities.*.id

    - version: 1.0
      name: Activity
      description: Persists Bill Of Material details in bom table
      fromTopic: save-bom-topic
      isTransaction: true
      isAuditEnabled: true
      module: Activity
      objecIdJsonPath: $.id
      tenantIdJsonPath: $.tenantId
      userUuidJsonPath: $.[0].auditDetails.createdBy
      transactionCodeJsonPath: $.id
      auditAttributeBasePath: $.*
      queryMaps:
        - query: INSERT INTO bom (id,tenant_id,facility_id,name,assign_user,data,is_active,additional_details,created_time,last_modified_time) VALUES (?,?,?,?,?,?,?,?,?,?);
          basePath: $.bom.*
          jsonMaps:
            - jsonPath: $.bom.*.id

            - jsonPath: $.bom.*.tenantId

            - jsonPath: $.bom.*.facilityId

            - jsonPath: $.bom.*.name

            - jsonPath: $.bom.*.assignUser

            - jsonPath: $.bom.*.data
              type: JSON
              dbType: JSONB

            - jsonPath: $.bom.*.isActive

            - jsonPath: $.bom.*.additionalDetails
              type: JSON
              dbType: JSONB

            - jsonPath: $.bom.*.auditDetails.createdTime

            - jsonPath: $.bom.*.auditDetails.lastModifiedTime

    - version: 1.0
      name: Activity
      description: Updates Bill Of Material details details in bom table
      fromTopic: update-bom-topic
      isTransaction: true
      isAuditEnabled: true
      module: ACTIVITY
      objecIdJsonPath: $.id
      tenantIdJsonPath: $.tenantId
      userUuidJsonPath: $.[0].auditDetails.createdBy
      transactionCodeJsonPath: $.id
      auditAttributeBasePath: $.*
      queryMaps:
        - query: UPDATE bom SET  assign_user=?, name=?, data=?, is_active=?, additional_details = ?, last_modified_time = ? WHERE id = ?;
          basePath: $.bom.*
          jsonMaps:
            - jsonPath: $.bom.*.assignUser

            - jsonPath: $.bom.*.name

            - jsonPath: $.bom.*.data
              type: JSON
              dbType: JSONB

            - jsonPath: $.bom.*.isActive

            - jsonPath: $.bom.*.additionalDetails
              type: JSON
              dbType: JSONB

            - jsonPath: $.bom.*.auditDetails.lastModifiedTime

            - jsonPath: $.bom.*.id
