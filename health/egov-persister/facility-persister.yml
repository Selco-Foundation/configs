serviceMaps:
  serviceName: facility-service
  mappings:
    - version: 1.0
      description: Persists a single FacilityAddress object
      fromTopic: save-facility
      isTransaction: true
      queryMaps:
        - query: >
            INSERT INTO facility_address (
              id, tenant_id, doorNo, latitude, longitude, locationAccuracy,
              type, addressLine1, addressLine2, landmark, city, pincode,
              buildingName, street, localityCode
            )
            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
          basePath: $.address
          jsonMaps:
            - jsonPath: $.address.addressId
            - jsonPath: $.address.tenantId
            - jsonPath: $.address.doorNo
            - jsonPath: $.address.latitude
            - jsonPath: $.address.longitude
            - jsonPath: $.address.locationAccuracy
            - jsonPath: $.address.type
            - jsonPath: $.address.addressLine1
            - jsonPath: $.address.addressLine2
            - jsonPath: $.address.landmark
            - jsonPath: $.address.city
            - jsonPath: $.address.pincode
            - jsonPath: $.address.buildingName
            - jsonPath: $.address.street
            - jsonPath: $.address.localityCode

    - version: 1.0
      description: Persists a single Facility object
      fromTopic: save-facility
      isTransaction: true
      queryMaps:
        - query: >
            INSERT INTO facility (id, tenant_id, facility_name, facility_type, facility_category, facility_subtype, facility_ownership, facility_region, addressId, facility_details,
              wf_status, additional_details, is_active, boundary_code, is_onm_ready, facility_poc_name, facility_poc_phone, facility_poc_email, hfr_id, nin_id, user_id, facility_status
            )
            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
          basePath: $
          jsonMaps:
            - jsonPath: $.facility_id
            - jsonPath: $.tenant_id
            - jsonPath: $.facility_name
            - jsonPath: $.facility_type
            - jsonPath: $.facility_category
            - jsonPath: $.facility_subtype
            - jsonPath: $.facility_ownership
            - jsonPath: $.facility_region
            - jsonPath: $.address.addressId
            - jsonPath: $.facility_details
              type: JSON
              dbType: JSONB
            - jsonPath: $.wfStatus
            - jsonPath: $.additionalDetails
              type: JSON
              dbType: JSONB
            - jsonPath: $.isActive
            - jsonPath: $.boundaryCode
            - jsonPath: $.isOnmReady
            - jsonPath: $.facility_poc_name
            - jsonPath: $.facility_poc_phone
            - jsonPath: $.facility_poc_email
            - jsonPath: $.hfr_id
            - jsonPath: $.nin_id
            - jsonPath: $.user_id
            - jsonPath: $.facility_status

    - version: 1.0
      description: Updates a single Facility object
      fromTopic: update-facility
      isTransaction: true
      queryMaps:
        - query: >
            UPDATE facility SET facility_name = ?, facility_type = ?, facility_subtype = ?, addressId = ?, facility_details = ?, additional_details = ?, is_onm_ready = ?,
            facility_poc_name = ?, facility_poc_phone = ?, facility_poc_email = ?, hfr_id = ?, nin_id = ?, user_id = ?, facility_status = ? 
            WHERE id = ? AND tenant_id = ?;
          basePath: $.FacilityUpdate
          jsonMaps:
            - jsonPath: $.FacilityUpdate.facility_name
            - jsonPath: $.FacilityUpdate.facility_type
            - jsonPath: $.FacilityUpdate.facility_subtype
            - jsonPath: $.FacilityUpdate.address.addressId
            - jsonPath: $.FacilityUpdate.facility_details
              type: JSON
              dbType: JSONB
            - jsonPath: $.FacilityUpdate.additionalDetails
              type: JSON
              dbType: JSONB
            - jsonPath: $.FacilityUpdate.isOnmReady
            - jsonPath: $.FacilityUpdate.facility_poc_name
            - jsonPath: $.FacilityUpdate.facility_poc_phone
            - jsonPath: $.FacilityUpdate.facility_poc_email
            - jsonPath: $.FacilityUpdate.hfr_id
            - jsonPath: $.FacilityUpdate.nin_id
            - jsonPath: $.FacilityUpdate.user_id
            - jsonPath: $.FacilityUpdate.facility_status
            - jsonPath: $.FacilityUpdate.facility_id
            - jsonPath: $.FacilityUpdate.tenant_id

    - version: 1.0
      description: Updates a single FacilityAddress object
      fromTopic: update-facility
      isTransaction: true
      queryMaps:
        - query: >
            UPDATE facility_address SET
              doorNo = ?, latitude = ?, longitude = ?, locationAccuracy = ?,
              type = ?, addressLine1 = ?, addressLine2 = ?, landmark = ?, city = ?,
              pincode = ?, buildingName = ?, street = ?, localityCode = ?
            WHERE id = ? AND tenant_id = ?;
          basePath: $.FacilityUpdate.address
          jsonMaps:
            - jsonPath: $.FacilityUpdate.address.doorNo
            - jsonPath: $.FacilityUpdate.address.latitude
            - jsonPath: $.FacilityUpdate.address.longitude
            - jsonPath: $.FacilityUpdate.address.locationAccuracy
            - jsonPath: $.FacilityUpdate.address.type
            - jsonPath: $.FacilityUpdate.address.addressLine1
            - jsonPath: $.FacilityUpdate.address.addressLine2
            - jsonPath: $.FacilityUpdate.address.landmark
            - jsonPath: $.FacilityUpdate.address.city
            - jsonPath: $.FacilityUpdate.address.pincode
            - jsonPath: $.FacilityUpdate.address.buildingName
            - jsonPath: $.FacilityUpdate.address.street
            - jsonPath: $.FacilityUpdate.address.localityCode
            - jsonPath: $.FacilityUpdate.address.addressId
            - jsonPath: $.FacilityUpdate.address.tenantId
